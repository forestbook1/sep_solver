#!/usr/bin/env python3
"""
Installation helper for interactive visualization dependencies.

This script checks if visualization dependencies are installed and
provides instructions for installation if needed.
"""

import sys
import subprocess


def check_package(package_name):
    """Check if a package is installed."""
    try:
        __import__(package_name)
        return True
    except ImportError:
        return False


def main():
    print("=" * 60)
    print("SEP Solver - Interactive Visualization Setup")
    print("=" * 60)
    print()
    
    # Check current status
    print("Checking dependencies...")
    print()
    
    networkx_installed = check_package("networkx")
    plotly_installed = check_package("plotly")
    
    print(f"  NetworkX: {'✓ Installed' if networkx_installed else '✗ Not installed'}")
    print(f"  Plotly:   {'✓ Installed' if plotly_installed else '✗ Not installed'}")
    print()
    
    if networkx_installed and plotly_installed:
        print("=" * 60)
        print("✓ All visualization dependencies are installed!")
        print("=" * 60)
        print()
        print("You can now use interactive visualization features:")
        print("  • engine.visualize_solution_interactive()")
        print("  • engine.visualize_solutions_comparison()")
        print("  • engine.visualize_solution_statistics()")
        print("  • engine.create_interactive_dashboard()")
        print()
        print("Try the example:")
        print("  python examples/interactive_visualization.py")
        print()
        return 0
    
    # Installation needed
    print("=" * 60)
    print("Installation Required")
    print("=" * 60)
    print()
    
    missing = []
    if not networkx_installed:
        missing.append("networkx")
    if not plotly_installed:
        missing.append("plotly")
    
    print(f"Missing packages: {', '.join(missing)}")
    print()
    
    # Ask user if they want to install
    response = input("Would you like to install them now? (y/n): ").strip().lower()
    
    if response in ['y', 'yes']:
        print()
        print("Installing visualization dependencies...")
        print()
        
        try:
            # Try using requirements file first
            result = subprocess.run(
                [sys.executable, "-m", "pip", "install", "-r", "requirements-viz.txt"],
                check=True,
                capture_output=True,
                text=True
            )
            print(result.stdout)
            
            print()
            print("=" * 60)
            print("✓ Installation complete!")
            print("=" * 60)
            print()
            print("Try the example:")
            print("  python examples/interactive_visualization.py")
            print()
            return 0
            
        except subprocess.CalledProcessError as e:
            print(f"Error during installation: {e}")
            print()
            print("Please try manual installation:")
            print("  pip install networkx plotly")
            print()
            return 1
    else:
        print()
        print("To install manually, run:")
        print("  pip install networkx plotly")
        print()
        print("Or use the requirements file:")
        print("  pip install -r requirements-viz.txt")
        print()
        return 0


if __name__ == "__main__":
    sys.exit(main())
